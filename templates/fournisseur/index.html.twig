{% extends 'base.html.twig' %}

{% block titre %}Liste des fournisseurs â€” Logix G-Stock{% endblock %}



{% block contenu %}
<h1 class="mb-4">ğŸ­ Fournisseurs</h1>

<form id="fournisseur-search-form" method="get" action="{{ path('app_fournisseur_index') }}" class="row g-2 mb-3">
  <div class="col-auto">
    <input type="text" name="q" value="{{ q ?? '' }}" class="form-control" placeholder="Rechercher par nom...">
  </div>
  <div class="col-auto">
    <button class="btn btn-primary" type="submit">Rechercher</button>
  </div>
</form>

<div id="fournisseur-table-wrapper">
  {% include 'fournisseur/_liste.html.twig' %}
</div>
{% endblock %}



{% block javascripts %}
  {{ parent() }}
  <script>
    const form = document.getElementById('client-search-form');
    const input = form.querySelector('input[name="q"]');
    const wrapper = document.getElementById('client-table-wrapper');

    function loadClients(queryString) {
      fetch('{{ path('app_client_index') }}' + queryString, {
        headers: {'X-Requested-With': 'XMLHttpRequest'}
      })
      .then(r => r.text())
      .then(html => {
        wrapper.innerHTML = html;
        bindClientPagination();
      });
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const q = input.value;
      loadClients('?q=' + encodeURIComponent(q) + '&page=1');
    });

    function bindClientPagination() {
      wrapper.querySelectorAll('.js-page').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          loadClients(this.getAttribute('href'));
        });
      });
    }

    bindClientPagination();
  </script>
{% endblock %}